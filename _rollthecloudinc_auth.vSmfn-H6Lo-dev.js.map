{
  "version": 3,
  "sources": ["../../@rollthecloudinc/auth/fesm2022/rollthecloudinc-auth.mjs"],
  "sourcesContent": ["import * as i1 from '@ngrx/store';\nimport { createFeatureSelector, createSelector, select, StoreModule } from '@ngrx/store';\nimport * as i0 from '@angular/core';\nimport { Injectable, PLATFORM_ID, Inject, Component, NgModule } from '@angular/core';\nimport { map, tap } from 'rxjs/operators';\nimport { CommonModule } from '@angular/common';\nimport { v4 } from 'uuid';\nimport * as i2 from '@angular/router';\nimport * as i1$1 from '@ngrx/data';\nvar AuthActionTypes;\n(function (AuthActionTypes) {\n  AuthActionTypes[\"Login\"] = \"[Auth] Login\";\n  AuthActionTypes[\"Logout\"] = \"[Auth] Logout\";\n  AuthActionTypes[\"CompleteAuthentication\"] = \"[Auth] CompleteAuthentication\";\n  AuthActionTypes[\"SetUser\"] = \"[Auth] SetUser\";\n})(AuthActionTypes || (AuthActionTypes = {}));\nclass Login {\n  constructor() {\n    this.type = AuthActionTypes.Login;\n  }\n}\nclass Logout {\n  constructor() {\n    this.type = AuthActionTypes.Logout;\n  }\n}\nclass CompleteAuthentication {\n  constructor() {\n    this.type = AuthActionTypes.CompleteAuthentication;\n  }\n}\nclass SetUser {\n  constructor(payload) {\n    this.payload = payload;\n    this.type = AuthActionTypes.SetUser;\n  }\n}\nconst fromAuthActions = {\n  Login,\n  Logout,\n  CompleteAuthentication,\n  SetUser\n};\nvar auth_actions = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  get AuthActionTypes() {\n    return AuthActionTypes;\n  },\n  CompleteAuthentication: CompleteAuthentication,\n  Login: Login,\n  Logout: Logout,\n  SetUser: SetUser,\n  fromAuthActions: fromAuthActions\n});\n\n// import { userInfo } from 'os';\nconst AUTH_FEATURE_KEY = 'auth';\nconst initialState = {\n  user: undefined,\n  cookies: new Map()\n};\nfunction reducer(state = initialState, action) {\n  switch (action.type) {\n    case AuthActionTypes.SetUser:\n      {\n        state = {\n          ...state,\n          user: action.payload\n        };\n        break;\n      }\n    case AuthActionTypes.Logout:\n      {\n        state = {\n          ...state,\n          user: undefined\n        };\n        break;\n      }\n  }\n  return state;\n}\nvar auth_reducer = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  AUTH_FEATURE_KEY: AUTH_FEATURE_KEY,\n  initialState: initialState,\n  reducer: reducer\n});\n\n// Lookup the 'Auth' feature state managed by NgRx\nconst getAuthState = createFeatureSelector(AUTH_FEATURE_KEY);\nconst getUser = createSelector(getAuthState, state => state.user);\nconst authQuery = {\n  getUser\n};\nvar auth_selectors = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  authQuery: authQuery\n});\nclass AuthFacade {\n  constructor(store) {\n    this.store = store;\n    this.getUser$ = this.store.pipe(select(authQuery.getUser));\n    this.token$ = this.store.pipe(select(authQuery.getUser), map(u => u ? `${u.token_type} ${u.access_token}` : undefined));\n    this.idToken$ = this.store.pipe(select(authQuery.getUser), map(u => u ? `${u.token_type} ${u.id_token}` : undefined));\n  }\n  login() {\n    this.store.dispatch(new Login());\n  }\n  logout() {\n    this.store.dispatch(new Logout());\n  }\n  setUser(user) {\n    this.store.dispatch(new SetUser(user));\n  }\n  completeAuthentication() {\n    this.store.dispatch(new CompleteAuthentication());\n  }\n  static {\n    this.\u0275fac = function AuthFacade_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AuthFacade)(i0.\u0275\u0275inject(i1.Store));\n    };\n  }\n  static {\n    this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n      token: AuthFacade,\n      factory: AuthFacade.\u0275fac,\n      providedIn: 'root'\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\u0275setClassMetadata(AuthFacade, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], () => [{\n    type: i1.Store\n  }], null);\n})();\nconst entityMetadata = {\n  PublicUserProfile: {\n    entityName: 'PublicUserProfile'\n  }\n};\nclass AuthCallbackComponent {\n  constructor(authFacade, router, route, platformId) {\n    this.authFacade = authFacade;\n    this.router = router;\n    this.route = route;\n    this.platformId = platformId;\n  }\n  async ngOnInit() {\n    // check for error\n    /*if (this.route.snapshot.fragment.indexOf('error') >= 0) {\n       this.error=true;\n       return;\n     }*/\n    //if(isPlatformBrowser(this.platformId)) {\n    this.authFacade.completeAuthentication();\n    this.router.navigate(['/pages/create-panel-page'], {\n      queryParams: {\n        cacheBuster: v4()\n      }\n    });\n    //}\n  }\n  static {\n    this.\u0275fac = function AuthCallbackComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AuthCallbackComponent)(i0.\u0275\u0275directiveInject(AuthFacade), i0.\u0275\u0275directiveInject(i2.Router), i0.\u0275\u0275directiveInject(i2.ActivatedRoute), i0.\u0275\u0275directiveInject(PLATFORM_ID));\n    };\n  }\n  static {\n    this.\u0275cmp = /* @__PURE__ */i0.\u0275\u0275defineComponent({\n      type: AuthCallbackComponent,\n      selectors: [[\"classifieds-ui-auth-callback\"]],\n      standalone: false,\n      decls: 2,\n      vars: 0,\n      template: function AuthCallbackComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.\u0275\u0275elementStart(0, \"p\");\n          i0.\u0275\u0275text(1, \"auth-callback works!\");\n          i0.\u0275\u0275elementEnd();\n        }\n      },\n      encapsulation: 2\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\u0275setClassMetadata(AuthCallbackComponent, [{\n    type: Component,\n    args: [{\n      selector: 'classifieds-ui-auth-callback',\n      standalone: false,\n      template: \"<p>auth-callback works!</p>\\n\"\n    }]\n  }], () => [{\n    type: AuthFacade\n  }, {\n    type: i2.Router\n  }, {\n    type: i2.ActivatedRoute\n  }, {\n    type: Object,\n    decorators: [{\n      type: Inject,\n      args: [PLATFORM_ID]\n    }]\n  }], null);\n})();\nclass AuthModule {\n  constructor(eds) {\n    eds.registerMetadataMap(entityMetadata);\n  }\n  static forRoot() {\n    return {\n      ngModule: AuthModule,\n      providers: [AuthFacade]\n    };\n  }\n  static {\n    this.\u0275fac = function AuthModule_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AuthModule)(i0.\u0275\u0275inject(i1$1.EntityDefinitionService));\n    };\n  }\n  static {\n    this.\u0275mod = /* @__PURE__ */i0.\u0275\u0275defineNgModule({\n      type: AuthModule\n    });\n  }\n  static {\n    this.\u0275inj = /* @__PURE__ */i0.\u0275\u0275defineInjector({\n      imports: [CommonModule,\n      // HttpClientModule,\n      StoreModule.forFeature(AUTH_FEATURE_KEY, reducer)]\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\u0275setClassMetadata(AuthModule, [{\n    type: NgModule,\n    args: [{\n      declarations: [AuthCallbackComponent],\n      imports: [CommonModule,\n      // HttpClientModule,\n      StoreModule.forFeature(AUTH_FEATURE_KEY, reducer)\n      // EffectsModule.forFeature([AuthEffects])\n      ],\n      exports: [AuthCallbackComponent]\n    }]\n  }], () => [{\n    type: i1$1.EntityDefinitionService\n  }], null);\n})();\nclass LogoutInterceptor {\n  constructor(authFacade, router) {\n    this.authFacade = authFacade;\n    this.router = router;\n  }\n  intercept(req, next) {\n    return next.handle(req).pipe(tap({\n      error: e => {\n        if (e.status === 401) {\n          // This breaks the server application remove for now.\n          // this.authFacade.logout();\n          // alert('You have been automatically logged out due to inactivity. Please login again.');\n          //this.router.navigateByUrl('/');\n        }\n      }\n    }));\n  }\n  static {\n    this.\u0275fac = function LogoutInterceptor_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || LogoutInterceptor)(i0.\u0275\u0275inject(AuthFacade), i0.\u0275\u0275inject(i2.Router));\n    };\n  }\n  static {\n    this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n      token: LogoutInterceptor,\n      factory: LogoutInterceptor.\u0275fac\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\u0275setClassMetadata(LogoutInterceptor, [{\n    type: Injectable\n  }], () => [{\n    type: AuthFacade\n  }, {\n    type: i2.Router\n  }], null);\n})();\nclass UserInfo {\n  constructor(data) {\n    if (data) {\n      this.sub = data.sub;\n    }\n  }\n}\nclass PublicUserProfile {\n  constructor(data) {\n    if (data) {\n      this.id = data.id;\n      this.userName = data.userName;\n    }\n  }\n}\nclass Cookie {\n  constructor(data) {\n    if (data) {\n      this.name = data.name;\n      this.value = data.value;\n    }\n  }\n}\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { AuthActionTypes, auth_actions as AuthActions, AuthCallbackComponent, AuthFacade, auth_reducer as AuthFeature, AuthModule, auth_selectors as AuthSelectors, CompleteAuthentication, Cookie, Login, Logout, LogoutInterceptor, PublicUserProfile, SetUser, UserInfo, fromAuthActions };\n"],
  "mappings": "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",
  "names": ["AuthActionTypes"]
}
