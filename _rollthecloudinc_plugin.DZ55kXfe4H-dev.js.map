{
  "version": 3,
  "sources": ["../../@rollthecloudinc/plugin/fesm2022/rollthecloudinc-plugin.mjs"],
  "sourcesContent": ["import * as i0 from '@angular/core';\nimport { NgModule, Injectable } from '@angular/core';\nimport * as i2 from '@rollthecloudinc/utils';\nimport { UtilsModule } from '@rollthecloudinc/utils';\nimport { of, forkJoin } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nclass PluginModule {\n  static {\n    this.\u0275fac = function PluginModule_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || PluginModule)();\n    };\n  }\n  static {\n    this.\u0275mod = /* @__PURE__ */i0.\u0275\u0275defineNgModule({\n      type: PluginModule\n    });\n  }\n  static {\n    this.\u0275inj = /* @__PURE__ */i0.\u0275\u0275defineInjector({\n      imports: [UtilsModule]\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\u0275setClassMetadata(PluginModule, [{\n    type: NgModule,\n    args: [{\n      declarations: [],\n      imports: [UtilsModule],\n      exports: []\n    }]\n  }], null, null);\n})();\nclass PluginConfigurationManager {\n  constructor() {\n    this.configs = [];\n  }\n  addConfig(cfg) {\n    this.configs.push(cfg);\n  }\n  getConfigs() {\n    return this.configs;\n  }\n  static {\n    this.\u0275fac = function PluginConfigurationManager_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || PluginConfigurationManager)();\n    };\n  }\n  static {\n    this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n      token: PluginConfigurationManager,\n      factory: PluginConfigurationManager.\u0275fac,\n      providedIn: 'root'\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\u0275setClassMetadata(PluginConfigurationManager, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], null, null);\n})();\nclass ConfigDiscovery {\n  constructor(pcm, moduleLoader) {\n    this.pcm = pcm;\n    this.moduleLoader = moduleLoader;\n  }\n  loadPlugins(pluginDef, ids = []) {\n    const configs = this.pcm.getConfigs();\n    const len = configs.length;\n    const loadModules$ = [];\n    for (let i = 0; i < len; i++) {\n      const len2 = configs[i].modules.length;\n      for (let j = 0; j < len2; j++) {\n        if (configs[i].modules[j].plugins.has(pluginDef.name) && (ids.length === 0 || ids.some(id => configs[i].modules[j].plugins.get(pluginDef.name).findIndex(p => p === id) > -1))) {\n          loadModules$.push(this.moduleLoader.loadModule(configs[i].modules[j].module));\n        }\n      }\n    }\n    if (loadModules$.length === 0) {\n      return of(true);\n    } else {\n      return forkJoin(loadModules$).pipe(map(() => true));\n    }\n  }\n  static {\n    this.\u0275fac = function ConfigDiscovery_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ConfigDiscovery)(i0.\u0275\u0275inject(PluginConfigurationManager), i0.\u0275\u0275inject(i2.ModuleLoaderService));\n    };\n  }\n  static {\n    this.\u0275prov = /* @__PURE__ */i0.\u0275\u0275defineInjectable({\n      token: ConfigDiscovery,\n      factory: ConfigDiscovery.\u0275fac,\n      providedIn: 'root'\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\u0275setClassMetadata(ConfigDiscovery, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], () => [{\n    type: PluginConfigurationManager\n  }, {\n    type: i2.ModuleLoaderService\n  }], null);\n})();\n\n// import { Injectable } from '@angular/core';\n// @Injectable()\nclass BasePluginManager {\n  constructor(pcm, moduleLoader) {\n    this.pcm = pcm;\n    this.moduleLoader = moduleLoader;\n    this.pluginInstances = new Map();\n    this.discoveryPipeline = [];\n    this.discovery();\n  }\n  discovery() {\n    this.discoveryPipeline.push(new ConfigDiscovery(this.pcm, this.moduleLoader));\n  }\n  addDiscovery(d) {\n    this.discoveryPipeline.push(d);\n  }\n  register(plugin) {\n    this.pluginInstances.set(plugin.id, plugin);\n  }\n  getPlugins(ids) {\n    const newPlugins = ids ? ids.filter(id => !this.pluginInstances.has(id)) : [];\n    if (ids && newPlugins.length === 0) {\n      return of(new Map(ids.map(id => [id, this.pluginInstances.get(id)])));\n    } else {\n      return this.pluginDef().pipe(switchMap(def => forkJoin(this.discoveryPipeline.map(d => d.loadPlugins(def, newPlugins))).pipe(map(() => ids ? new Map(ids.map(id => [id, this.pluginInstances.get(id)])) : this.pluginInstances))));\n    }\n  }\n  getPlugin(id) {\n    if (this.pluginInstances.has(id)) {\n      return of(this.pluginInstances.get(id));\n    } else {\n      return this.pluginDef().pipe(switchMap(def => forkJoin(this.discoveryPipeline.map(d => d.loadPlugins(def, [id]))).pipe(map(() => this.pluginInstances.get(id)))));\n    }\n  }\n}\nclass PluginConfig {\n  constructor(data) {\n    this.modules = [];\n    if (data) {\n      if (data.modules) {\n        this.modules = data.modules.map(m => new PluginConfigModule(m));\n      }\n    }\n  }\n}\nclass Plugin {\n  constructor(data) {\n    if (data) {\n      this.id = data.id;\n      this.title = data.title;\n    }\n  }\n}\nclass PluginDef {\n  constructor(data) {\n    if (data) {\n      this.name = data.name;\n    }\n  }\n}\nclass PluginConfigModule {\n  constructor(data) {\n    if (data) {\n      this.module = data.module;\n      if (data.plugins) {\n        this.plugins = new Map([...data.plugins]);\n      }\n    }\n  }\n}\n/*export class BasePlugin implements Plugin {\n}*/\n\n/*\n * Public API Surface of plugin\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { BasePluginManager, ConfigDiscovery, Plugin, PluginConfig, PluginConfigModule, PluginConfigurationManager, PluginDef, PluginModule };\n"],
  "mappings": "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",
  "names": []
}
